- **하나의 Docker Compose YAML 파일**에 여러 서비스를 정의해도, 각 서비스는 **별도의 컨테이너로 실행**됩니다.
- 이들 컨테이너는 동일한 네트워크에 속하여 **컨테이너 이름으로 연결**됩니다.
- 따라서 **MySQL, Redis, Spring Boot**가 각각 독립된 컨테이너로 실행되며, 네트워크를 통해 서로 통신합니다.

이 방식으로, 각 컨테이너가 독립적으로 실행되면서도 필요한 서비스들 간의 **연결과 의존성**을 쉽게 관리할 수 있습니다.

### **Compose의 역할과 장점**

Docker Compose는 **여러 컨테이너를 한 번에 실행하고 관리**할 수 있게 도와주는 툴입니다. 각 컨테이너를 별도로 실행하는 것과 비교했을 때 **네트워크 관리와 설정이 더 간편**합니다.

### 주요 기능:

- **네트워크 자동 생성**: 컨테이너 간 네트워크 연결을 위한 **bridge 네트워크를 자동 생성**합니다.
- **환경 변수 관리**: 환경 변수를 쉽게 설정하고 공유할 수 있습니다.
- **종속성 관리**: `depends_on` 옵션으로 컨테이너 간의 **의존성**을 설정합니다.
- **단일 명령으로 실행**: `docker-compose up`으로 여러 컨테이너를 동시에 실행할 수 있습니다.
- **볼륨 관리**: 데이터 영속성을 위해 **볼륨**을 쉽게 정의할 수 있습니다.

## **Auto Scaling과 Docker Compose**

오토스케일링 환경에서는 각 서버에서 **Spring Boot 인스턴스를 동적으로 늘리고 줄여야** 합니다.

예:

1. 트래픽이 증가하면 여러 서버에 **Spring Boot 인스턴스를 늘려** 트래픽을 분산 처리.
2. 트래픽이 줄어들면 인스턴스를 자동으로 **축소**.

하지만 Docker Compose는 **고정된 YAML 파일에 따라 정해진 컨테이너만 실행**하기 때문에 **동적 확장**이 어렵습니다. 대신, **Kubernetes**와 같은 도구가 이런 환경에서 적합합니다.

**-궁금증-**

그렇다면 같은 **EC2**내에 모든 **서비스**를 올려두는 방식을 활용하면 되지않나?

## **모든 서비스(예: Spring Boot, Redis, MySQL)를 같은 EC2에 배포하는 경우의 문제점**

### 1. **자원 경쟁 (Resource Contention)**

- **CPU, 메모리, 네트워크 자원을 Redis, MySQL, Spring Boot**가 하나의 인스턴스에서 공유하게 됩니다.
- 트래픽이 증가하면 **데이터베이스 쿼리와 애플리케이션 로직**이 동시에 자원을 요구하게 되어 **성능 저하**가 발생할 수 있습니다.

---

### 2. **확장성 문제 (Scaling Bottleneck)**

- **EC2 인스턴스를 늘려도** 하나의 인스턴스에 모든 서비스를 실행하면 **수평 확장(Scaling Out)**이 어렵습니다.
    - 예를 들어, 애플리케이션은 3대가 필요하고 MySQL은 1대만 필요하다면, 같은 인스턴스에 모든 서비스를 올리면 불필요하게 MySQL도 중복됩니다.
- **데이터베이스는 수평 확장**이 어려워 **오토스케일링의 효과**를 극대화하기 어렵습니다.
    - 따라서 MySQL과 Redis 같은 서비스는 **독립된 인스턴스나 매니지드 서비스**로 배치하는 것이 좋습니다.

---

### 3. **고가용성(High Availability)과 장애 대응**

- 하나의 EC2 인스턴스가 다운되면 **애플리케이션과 데이터베이스가 동시에 중단**됩니다.
- **Redis, MySQL** 등은 **데이터 유실**을 방지하기 위해 **복제본(Replica)**이 필요할 수 있습니다.
- 여러 EC2에 서비스를 분리하면, **한 인스턴스가 장애**가 나더라도 다른 인스턴스가 서비스를 유지합니다.